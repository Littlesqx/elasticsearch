[[dynamic]]
=== `dynamic`

默认情况下，只需通过索引包含新字段的文档，即可将字段 _dynamically_ 添加到文档或文档中的 <<object,内部对象>> 。例如：

[source,js]
--------------------------------------------------
PUT my_index/_doc/1 <1>
{
  "username": "johnsmith",
  "name": {
    "first": "John",
    "last": "Smith"
  }
}

GET my_index/_mapping <2>

PUT my_index/_doc/2 <3>
{
  "username": "marywhite",
  "email": "mary@white.com",
  "name": {
    "first": "Mary",
    "middle": "Alice",
    "last": "White"
  }
}

GET my_index/_mapping <4>
--------------------------------------------------
// CONSOLE
<1> 本文档介绍字符串字段 `username` ，对象字段 `name` ，以及 `name` 对象下的两个字符串字段，可以称为 `name.first`和`name.last` 。
<2> 检查映射以验证上述情况。
<3> 该文档添加了两个字符串字段： `email` 和 `name.middle` 。
<4> 检查映射以验证更改。

有关如何检测新字段并将其添加到映射的详细信息，请参见 <<dynamic-mapping>>。

`dynamic` 设置控制是否可以动态添加新字段。它接受三种设置：

[horizontal]
`true`::    新检测到的字段将添加到映射中。 （默认）
`false`::   新检测到的字段将被忽略。这些字段不会被索引，因此无法搜索，但仍会出现在返回匹配的 `_source` 字段中。这些字段不会添加到映射中，必须显式添加新字段。
`strict`::  如果检测到新字段，则抛出异常并拒绝该文档。必须将新字段显式添加到映射中。

可以在映射类型级别和每个<<object,内部对象>>上设置 `dynamic` 。内部对象从其父对象或映射类型继承该设置。例如：

[source,js]
--------------------------------------------------
PUT my_index
{
  "mappings": {
    "_doc": {
      "dynamic": false, <1>
      "properties": {
        "user": { <2>
          "properties": {
            "name": {
              "type": "text"
            },
            "social_networks": { <3>
              "dynamic": true,
              "properties": {}
            }
          }
        }
      }
    }
  }
}
--------------------------------------------------
// CONSOLE
<1> 在类型级别禁用动态映射，因此不会动态添加新的顶级字段。
<2> `user` 对象继承了类型级别设置。
<3> `user.social_networks` 对象启用动态映射，因此可以将新字段添加到此内部对象。

提示：可以使用 <<indices-put-mapping,PUT mapping API>> 在现有字段上更新 `dynamic` 设置。
